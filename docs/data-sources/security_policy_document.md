---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "gitlab_security_policy_document Data Source - terraform-provider-gitlab"
subcategory: ""
description: |-
  Generates a GitLab security policy YAML document from structured configuration.
  This data source performs pure transformation without any API calls.
  Upstream API: GitLab Security Policies Documentation https://docs.gitlab.com/ee/user/application_security/policies/scan_execution_policies/
---

# gitlab_security_policy_document (Data Source)

Generates a GitLab security policy YAML document from structured configuration.
This data source performs pure transformation without any API calls.

**Upstream API**: [GitLab Security Policies Documentation](https://docs.gitlab.com/ee/user/application_security/policies/scan_execution_policies/)

## Example Usage

```terraform
# Use this with `gitlab_repository_file` to manage your policies using native HCL
data "gitlab_security_policy_document" "scan" {
  scan_execution_policy = [
    {
      name    = "Basic SAST Policy"
      enabled = true

      rules = [
        {
          type        = "pipeline"
          branch_type = "all"
        }
      ]

      actions = [
        {
          scan = "sast"
        }
      ]
    }
  ]
}

# See `gitlab_project_security_policy_attachment` or `gitlab_group_security_policy_attachment`
# for how to link a security policy project to a project or group.
resource "gitlab_repository_file" "policy" {
  # The security policy project linked to the group or project
  project = 1234
  ref     = "main"

  # This name is important, don't change it!
  # see https://docs.gitlab.com/user/application_security/policies/enforcement/security_policy_projects/
  file_path = ".gitlab/security-policies/policy.yml"
  content   = data.gitlab_security_policy_document.scan.yaml
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Optional

- `scan_execution_policy` (Attributes List) Scan execution policy configuration. Multiple policies can be specified. (see [below for nested schema](#nestedatt--scan_execution_policy))

### Read-Only

- `id` (String) Unique identifier for this policy document (hash of generated YAML).
- `yaml` (String) The generated policy document in YAML format, ready to write to `.gitlab/security-policies/policy.yml`.

<a id="nestedatt--scan_execution_policy"></a>
### Nested Schema for `scan_execution_policy`

Required:

- `actions` (Attributes List) Actions to execute when rules match. At least one action is required. (see [below for nested schema](#nestedatt--scan_execution_policy--actions))
- `enabled` (Boolean) Whether the policy is enabled.
- `name` (String) Name of the scan execution policy.
- `rules` (Attributes List) Rules that trigger the policy. At least one rule is required. (see [below for nested schema](#nestedatt--scan_execution_policy--rules))

Optional:

- `description` (String) Description of the scan execution policy.
- `policy_scope` (Attributes) Scope configuration to limit which projects the policy applies to. (see [below for nested schema](#nestedatt--scan_execution_policy--policy_scope))
- `skip_ci` (Attributes) Control whether users can use the skip-ci directive. (see [below for nested schema](#nestedatt--scan_execution_policy--skip_ci))

<a id="nestedatt--scan_execution_policy--actions"></a>
### Nested Schema for `scan_execution_policy.actions`

Required:

- `scan` (String) Type of scan to run. Valid values: `sast`, `secret_detection`, `container_scanning`, `dependency_scanning`, `dast`, `sast_iac`, `cluster_image_scanning`, `api_fuzzing`, `coverage_fuzzing`.

Optional:

- `scanner_profile` (String) Scanner profile to use for DAST scans.
- `site_profile` (String) Site profile to use for DAST scans.
- `tags_to_exclude` (List of String) Tags to exclude from the scan.
- `template` (String) The template to use for the scan. Valid values: `default`, `latest`.
- `variables` (Map of String) Environment variables to pass to the scan job.


<a id="nestedatt--scan_execution_policy--rules"></a>
### Nested Schema for `scan_execution_policy.rules`

Required:

- `type` (String) Type of rule. Valid values: `pipeline`, `schedule`, `agent`.

Optional:

- `agents` (Map of String) Kubernetes agents configuration for agent-based policies.
- `branch_exceptions` (List of String) Branches to exclude from the policy.
- `branch_type` (String) Type of branches to match. Valid values: `all`, `protected`, `default`.
- `branches` (List of String) Branch names or patterns to match.
- `cadence` (String) Cron expression for schedule type rules (e.g., `*/15 * * * *` for every 15 minutes).


<a id="nestedatt--scan_execution_policy--policy_scope"></a>
### Nested Schema for `scan_execution_policy.policy_scope`

Optional:

- `compliance_frameworks` (List of String) Compliance framework names to scope the policy to.
- `projects` (Attributes) Project scope configuration. (see [below for nested schema](#nestedatt--scan_execution_policy--policy_scope--projects))

<a id="nestedatt--scan_execution_policy--policy_scope--projects"></a>
### Nested Schema for `scan_execution_policy.policy_scope.projects`

Optional:

- `excluding` (List of Number) List of project IDs to exclude from this policy.
- `including` (List of Number) List of project IDs to explicitly include in this policy.



<a id="nestedatt--scan_execution_policy--skip_ci"></a>
### Nested Schema for `scan_execution_policy.skip_ci`

Required:

- `allowed` (Boolean) Allow (true) or prevent (false) the use of skip-ci directive.
