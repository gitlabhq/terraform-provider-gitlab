---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "gitlab_cluster_agent Resource - terraform-provider-gitlab"
subcategory: ""
description: |-
  The gitlab_cluster_agent resource allows to manage the lifecycle of a GitLab Agent for Kubernetes.
  -> Note that this resource only registers the agent, but doesn't configure it.
  The configuration needs to be manually added as described in
  the docs https://docs.gitlab.com/user/clusters/agent/install/index/#create-an-agent-configuration-file.
  However, a gitlab_repository_file resource may be used to achieve that.
  -> Requires at least maintainer permissions on the project.
  Upstream API: GitLab REST API docs https://docs.gitlab.com/api/cluster_agents/
---

# gitlab_cluster_agent (Resource)

The `gitlab_cluster_agent` resource allows to manage the lifecycle of a GitLab Agent for Kubernetes.

-> Note that this resource only registers the agent, but doesn't configure it.
   The configuration needs to be manually added as described in
   [the docs](https://docs.gitlab.com/user/clusters/agent/install/index/#create-an-agent-configuration-file).
   However, a `gitlab_repository_file` resource may be used to achieve that.

-> Requires at least maintainer permissions on the project.

**Upstream API**: [GitLab REST API docs](https://docs.gitlab.com/api/cluster_agents/)

## Example Usage

```terraform
resource "gitlab_cluster_agent" "example" {
  project = "12345"
  name    = "agent-1"
}

// Optionally, configure the agent as described in
// https://docs.gitlab.com/user/clusters/agent/install/index/#create-an-agent-configuration-file
resource "gitlab_repository_file" "example_agent_config" {
  project   = gitlab_cluster_agent.example.project
  branch    = "main" // or use the `default_branch` attribute from a project data source / resource
  file_path = ".gitlab/agents/${gitlab_cluster_agent.example.name}/config.yaml"
  encoding  = "base64"
  content = base64encode(<<CONTENT
# the GitLab Agent for Kubernetes configuration goes here ...
  CONTENT
  )
  author_email   = "terraform@example.com"
  author_name    = "Terraform"
  commit_message = "feature: add agent config for ${gitlab_cluster_agent.example.name} [skip ci]"
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String) The Name of the agent.
- `project` (String) ID or full path of the project maintained by the authenticated user.

### Read-Only

- `agent_id` (Number) The ID of the agent.
- `created_at` (String) The ISO8601 datetime when the agent was created.
- `created_by_user_id` (Number) The ID of the user who created the agent.
- `id` (String) The ID of this resource. In the format <project:agent_id>

## Import

Starting in Terraform v1.5.0, you can use an [import block](https://developer.hashicorp.com/terraform/language/import) to import `gitlab_cluster_agent`. For example:

```terraform
import {
  to = gitlab_cluster_agent.example
  id = "see CLI command below for ID"
}
```

Importing using the CLI is supported with the following syntax:

```shell
# GitLab Agent for Kubernetes can be imported with the following command and the id pattern `<project>:<agent-id>`
terraform import gitlab_cluster_agent.example '12345:42'
```
